# setup ##########################

```{r}
library(tidyverse)
library(readxl)
library(janitor)
library(sf)
library(stringr)
library(readr)
library(dplyr)
library(ggplot2)
library(USAboundaries)
library(USAboundariesData)
library(magrittr)
library(readxl)
```

# Loading Data #############
```{r}
coords <- read_excel("../output/cleaned/cleanedBoth/combined_Coordinates_Quality.xlsx")

coords
```

# Wrangling
```{r}
coords_w <- coords %>%
  # Standardizing names
  #clean_names() %>%
  # Select target columns  
  mutate(Latitude = gsub("° N", "", as.character(Latitude)),
         Longitude = gsub("° W", "", as.character(Longitude))) %>%
  mutate(Latitude = as.numeric(Latitude),
         Longitude = as.numeric(Longitude))

## View entire decimal value  ########
options(digits =6)

## Transform into geospatial object #################
# remove NA and * -1 
test <- coords_w |>
  drop_na(Latitude, Longitude) |> 
  mutate(Longitude = Longitude *-1)

#print(as.data.frame(coords_w[30:45, ])) # these rows show values that had N/W

# Transform into geospatial object
coords_w %>%
  filter(is.na(loc)) %>%
  distinct(year)
  filter(is.na(Longitude) | is.na(Latitude))
  dplyr::select(Longitude, Latitude) %>%
  summary
  
coords_w
  
```

# EDA
```{r}
# Will check data with tabular summaries and graphs. - `summary()` - `ggplot()`
states_contemporary <- us_states()

# save plot to coord_plot object 
coord_plot <- ggplot()+
  geom_point(data = test, aes(x = Longitude, y = Latitude))+
  geom_sf(data = states_contemporary, fill = NA)

coord_plot  

```
Checking Alaska location
```{r}
coords_w %>%
  filter(Longitude > 121) 
```

# Plot to file 

```{r}
# use ggsave() (svg, png, pdf)
ggsave(path = "../figs", "coords_plot.png", plot=coord_plot) 
```

