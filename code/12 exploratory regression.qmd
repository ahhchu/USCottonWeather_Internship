Run some exploratory regressions with fiber strength vs. year

overall (one regression line)
per region (SE, SW, SC, etc.), one line per region
per state, one line per state

# setup 

```{r}
library(tidyverse)
library(readr)
library(ggplot2)
library(dplyr)
```

# load data
```{r}
data <- read.csv("../data/daymet/fieldweather_final.csv")
```
```{r overall}
# linear regression model
model <- lm(str_emmean ~ year, data = data)

# scatter plot w regression line for overall 
# fiber strength vs year 
overallPlot <- ggplot(data, aes(x = year, y = str_emmean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "Year", y = "Fiber Strength")
```

```{r per region} 
# SE, SW, SC,
# Define regions based on states or locations
data <- data %>%
  mutate(region = case_when(
    grepl("AZ|NM|OK|CA", loc) ~ "South_West",
    grepl("TX|LA|AR|LA|MO", loc) ~ "South_Central",
    grepl("FL|GA|AL|TN|MS", loc) ~ "South_East",
    TRUE ~ "Other"
  ))

region_plot_list <- list()

# Create separate plots for each region
for (reg in unique(data$region)) {
  region_df <- data %>% filter(region == reg)
  
  # Create ggplot object for the current region
  plot <- ggplot(region_df, aes(x = year, y = str_emmean)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE) +
    labs(x = "Year", y = "str_emmean", title = paste("Regression Line for", reg))
  
  # Store the plot object in the list with the region information as the name
  region_plot_list[[reg]] <- plot
}
region_plot_list[['South_West']]
region_plot_list[['South_Central']]
region_plot_list[['South_East']]
```


```{r per state}
# splitting data by loc 
grouped <- split(data, data$loc)
state_plot_list <- list()


for (loc in names(grouped)) {
  group_df <- grouped[[loc]]
    # ggplot for each loc
  plot <- ggplot(group_df, aes(x = year, y = str_emmean)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE) +
    labs(x = "Year", y = "str_emmean", title = paste("Regression Line for", loc))
    state_plot_list[[loc]] <- plot
}

# accessing a state Altus, OK
state_plot_list[['Altus, OK']]
# Yuma, AZ
state_plot_list[['Yuma, AZ']]

```



```{r per region 2}
data %>%
  ggplot(aes(x = year, y = str_emmean, color = region)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)+
  facet_grid(.~region)+
  theme(legend.position = "none")

str ~ region*year
str ~ region + year + region:year

```

```{r per state 2}
data %>%
  ggplot(aes(x = year, y = str_emmean, color = state)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)+
  facet_grid(.~state)+
  theme(legend.position = "none")

str ~ region*year
str ~ region + year + region:year

```

